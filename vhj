| Source_DB | Source_Table | Source_Field                                 | Target_Table | Business_Logic                                                                                                                                                                |
| --------- | ------------ | -------------------------------------------- | ------------ | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| FILE      | Hierarchy_In | gfcid                                        | LR_File      | In NRMZ, gfcid is passed through. In FBE-1, the row is kept only when agg_hierarchy_t.parent_gfcid is not null. In RFMT, gfcid is written to the LR File.                     |
| FILE      | Hierarchy_In | id_type                                      | LR_File      | In NRMZ, id_type is passed through directly. The FBE-1 filter ensures only valid hierarchy rows are kept. RFMT writes id_type to the LR File.                                 |
| FILE      | Hierarchy_In | batch_dt                                     | LR_File      | batch_dt is passed through NRMZ, only retained if parent_gfcid is not null in FBE-1, and then written by RFMT.                                                                |
| FILE      | Hierarchy_In | client_type                                  | LR_File      | client_type flows unchanged through NRMZ, is retained if the row passes the parent_gfcid filter, and written to the target.                                                   |
| FILE      | Hierarchy_In | month                                        | LR_File      | month passes through NRMZ, is filtered in FBE-1, and written to LR File in RFMT.                                                                                              |
| FILE      | Hierarchy_In | year                                         | LR_File      | year is carried unchanged through NRMZ, filtered in FBE-1, and written by RFMT.                                                                                               |
| FILE      | Hierarchy_In | country                                      | LR_File      | country passes through NRMZ unchanged, filtered in FBE-1 for valid rows, and written by RFMT.                                                                                 |
| FILE      | Hierarchy_In | agg_hierarchy[index].agg                     | LR_File      | In NRMZ, agg is derived from the hierarchy array element; if switch_flag='Y', it takes value from index+1. FBE-1 keeps only non-null parent_gfcid rows, and RFMT writes agg.  |
| FILE      | Hierarchy_In | agg_hierarchy[index].cntry_code              | LR_File      | NRMZ derives cntry_code from the current or next array element based on switch_flag. Rows must pass FBE-1 before RFMT writes cntry_code.                                      |
| FILE      | Hierarchy_In | agg_hierarchy[index].cntry_appx_id           | LR_File      | NRMZ assigns cntry_appx_id based on switch_flag, ensuring correct parent-child context; FBE-1 filters invalid rows; RFMT writes cntry_appx_id.                                |
| FILE      | Hierarchy_In | agg_hierarchy[index].country_appx_state      | LR_File      | NRMZ determines country_appx_state from hierarchy array; only valid rows are retained by FBE-1; RFMT writes to output.                                                        |
| FILE      | Hierarchy_In | agg_hierarchy[index].country_appx_status     | LR_File      | NRMZ assigns country_appx_status using the switch_flag rule; rows failing FBE-1 are dropped; RFMT writes this field.                                                          |
| FILE      | Hierarchy_In | agg_hierarchy[index].citi_service_cntry_code | LR_File      | NRMZ resolves citi_service_cntry_code with the switch_flag fix (UAT #28454). Rows passing FBE-1 are written to LR File by RFMT.                                               |
| FILE      | Hierarchy_In | switch_flag (derived)                        | LR_File      | In NRMZ, switch_flag is derived as 'Y' when the last element has null parent_gfcid and the current index is second-last; it controls value substitution for hierarchy fields. |
