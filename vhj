Parameters Used

${REGION} → Region code passed dynamically (e.g., “M”, “K”, “C”, etc.)

${PROCESS_REGION} → Vector or list of allowed region names (used in lookup)

Lookup Table: ISO_COUNTRY_LKP – a lookup table containing country-to-region mappings

Fields Used: agg_country, transaction_country, custom_region

Select Expression (Filter Condition)

The filter expression used in the Region Filter component is:

(starts_with('${REGION}','M') and agg_country=='MX') or
(starts_with('${REGION}','K') and agg_country=='KR') or
(starts_with('${REGION}','C') and transaction_country=='CN') or
lookup("ISO_COUNTRY_LKP", agg_country).custom_region member [vector ${PROCESS_REGION}]

4. Business Logic (Step-by-Step Explanation)

The graph begins by reading all records from KYC_GBL_MAIN.TRADE_HIERARCHY_INTF.

The Region Filter checks each record to see if it matches the target processing region using a series of conditional rules.

The expression includes hardcoded regional conditions for key countries (Mexico, Korea, China) and lookup-based matching for other countries.

Rule Details:

Mexico Condition:
If the ${REGION} parameter starts with “M” and the agg_country value is 'MX', the record is selected.

Korea Condition:
If the ${REGION} parameter starts with “K” and the agg_country value is 'KR', the record is selected.

China Condition:
If the ${REGION} parameter starts with “C” and the transaction_country is 'CN', the record is selected.

Generic Lookup Condition:
For other regions, the component uses a lookup file ISO_COUNTRY_LKP to find the custom_region of the agg_country.
If this custom_region is part of the list [vector ${PROCESS_REGION}], then the record is included.

5. Outputs and Routing

Main Output (AGGR Hierarchy Extr):
The filtered records that satisfy the region logic are written to the output dataset AGGR Hierarchy Extr.
These records represent the trade hierarchy data relevant to the selected region.

Trash / Trash-1 Outputs:
These are discard paths used to route records that do not match the filter criteria.

Trash: For records that fail lookup or don’t belong to any region.

Trash-1: For special rejects or data that cannot be associated with a valid region.
