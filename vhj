| Source_DB        | Source_Table         | Source_Field  | Target_Table             | Business_Logic                                                                                                                                                                                                                                                                                                        |
| ---------------- | -------------------- | ------------- | ------------------------ | --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **KYC_GBL_MAIN** | **AMC_ENTITY_GFCID** | **GFCID**     | **AMC_ENTITY_GFCID_CIS** | Row qualifies only when **exactly one** NAICS_1..NAICS_6 is non-null (`CNT = NVL2(NAICS_1,1,0)+…+NVL2(NAICS_6,1,0) = 1`). For qualified rows, write **GFCID** to target (also used as lookup **key {gfcid}**) together with **NAICS_ID** derived as `first_defined(NAICS_1,NAICS_2,NAICS_3,NAICS_4,NAICS_5,NAICS_6)`. |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **UNIQUE_ID** | AMC_ENTITY_GFCID_CIS     | Present in extract only; does **not** flow to target. Row still subject to the same qualification: `CNT=1` based on NAICS_1..6; NAICS_ID derived via `first_defined(...)`.                                                                                                                                            |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **GFPID**     | AMC_ENTITY_GFCID_CIS     | Present in extract only; does **not** flow to target. Row must satisfy `CNT=1`; NAICS_ID derived via `first_defined(...)`.                                                                                                                                                                                            |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_1**   | AMC_ENTITY_GFCID_CIS     | Contributes **1** to `CNT` when not null; overall filter requires the **sum across NAICS_1..6 = 1**. Also first candidate in `NAICS_ID = first_defined(NAICS_1..NAICS_6)`; i.e., **if NAICS_1 is non-null and NAICS_2..6 are null, NAICS_ID = NAICS_1**; otherwise ignored. Target writes `{GFCID, NAICS_ID}` only.   |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_2**   | AMC_ENTITY_GFCID_CIS     | Contributes **1** to `CNT` when not null; row passes only if total across NAICS_1..6 equals **1**. Second in precedence for `first_defined(...)`; **if NAICS_1 is null and NAICS_2 is non-null (and NAICS_3..6 null), NAICS_ID = NAICS_2**; else ignored.                                                             |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_3**   | AMC_ENTITY_GFCID_CIS     | Same: adds **1** to `CNT` if non-null; row kept only if overall `CNT=1`. Third in precedence; **chosen as NAICS_ID** only when NAICS_1,2 are null and NAICS_3 is the sole non-null.                                                                                                                                   |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_4**   | AMC_ENTITY_GFCID_CIS     | Same behavior: contributes to `CNT`; row must have exactly one NAICS non-null. Fourth in `first_defined(...)`; **picked as NAICS_ID** only when it is the **only** non-null among NAICS_1..6.                                                                                                                         |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_5**   | AMC_ENTITY_GFCID_CIS     | Same: contributes to `CNT`; pass only if `CNT=1`. Fifth in precedence; **becomes NAICS_ID** only when it’s the sole populated NAICS.                                                                                                                                                                                  |
| KYC_GBL_MAIN     | AMC_ENTITY_GFCID     | **NAICS_6**   | AMC_ENTITY_GFCID_CIS     | Same: contributes to `CNT`; pass only if `CNT=1`. Sixth in precedence; **becomes NAICS_ID** only when it’s the sole populated NAICS.                                                                                                                                                                                  |
