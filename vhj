Overall purpose

The Load Status Update graph refreshes the LOAD_STATUS and audit columns (LST_UPD_DT, LST_UPD_ID, LST_UPD_TIME) in each region’s KYC Trade Interface summary tables.
It reads a single flat file of load-status records, replicates those records to the three regional subgraphs, and inside each subgraph runs four SQL UPDATE statements—one for each summary table.

Source

The graph reads from the file $WI_LOAD_STATUS_FILE, which is a delimited flat file such as
/abinitio/data/CitiTech/mfs/mfs_way/GFTS/KYC/etl_interfaces/reject/..._load_status_YYYYMMDD_YYYYMMDDHHMMSS.dat.
Each record contains the following fields:

id, id_type, client_type, country, month, year, batch_id, batch_dt, load_status, feed_type, lst_upd_id, lst_upd_dt, lst_upd_time.

Replication

Every record is replicated to the three output branches: NAM, APAC, and IDN.
Whether a branch executes is decided by its condition expression.

Branch-selection logic (line by line)
NAM branch
${ if(
      (REGION != 'NAM')
   and ('NAM' member string_split_no_empty(DB_REGION_LIST, "\n"))
   ) 1 else 0 }

APAC branch
${ if(
      (REGION != 'APAC')
   and ('APAC' member string_split_no_empty(DB_REGION_LIST, "\n"))
   ) 1 else 0 }

IDN branch
${ if(
      (REGION != 'IDN')
   and ('IDN' member string_split_no_empty(DB_REGION_LIST, "\n"))
   ) 1 else 0 }


Sentence meaning:
For each region, the subgraph runs only when the job’s global REGION parameter is not equal to that region name and the same region code is explicitly listed in the newline-delimited parameter DB_REGION_LIST.
If both parts are true, the expression returns 1 and that branch executes; otherwise it is skipped.

Processing inside every regional subgraph

Each branch contains an identical Multi-Update Table (MUT) component named MUT_<REGION>.

DBConfigFile → region-specific connection ($APAC_DBC, $IDN_DBC, etc.).

commitTable → $COMMIT_TABLE to ensure transactional commits.

batchSize = 1, continuous = False for row-level commit control.

count = 4 because four SQL scripts run sequentially.

SQL files executed (same for all regions)

$AI_SQL/kyc_interface_giw_TRADE_TXN_SMRY_load_status_update.sql

$AI_SQL/kyc_interface_giw_TRADE_TXN_SMRy_JURIS_load_status_update.sql

$AI_SQL/kyc_interface_giw_TRADE_TXN_COMMODITY_SMRY_load_status_update.sql

$AI_SQL/kyc_interface_giw_TRADE_TXN_LC_SMRy_JURIS_load_status_update.sql

Each file contains the same parameterized statement; only the table name changes.

Resolved SQL statement
UPDATE KYC_RGN_STG.<TABLE_NAME>
   SET LOAD_STATUS = :load_status,
       LST_UPD_DT  = :lst_upd_dt,
       LST_UPD_ID  = :lst_upd_id,
       LST_UPD_TIME= :lst_upd_time
 WHERE ID          = :id
   AND ID_TYPE     = :id_type
   AND CLIENT_TYPE = :client_type
   AND COUNTRY     = :country
   AND MONTH       = :month
   AND YEAR        = :year
   AND BATCH_DT    = :batch_dt;


Sentence explanation:
For every record passed into the MUT, Ab Initio substitutes the field values from the Load Status File into the named parameters, finds the matching row in each regional target table using the composite key (id, id_type, client_type, country, month, year, batch_dt), and updates its status and timestamp columns.

Reject and error handling

If an update fails—because the key is missing, the record violates a constraint, or a database error occurs—the failing row is written to that region’s Reject and Error dataset (for example, NAM-Reject and Error).
These reject flows capture the original record plus standard error metadata such as component name, SQL code, and error message.

Targets

Each active regional branch updates four Oracle tables in its own schema:

KYC_RGN_STG.TRADE_TXN_SMRY

KYC_RGN_STG.TRADE_TXN_SMRy_JURIS

KYC_RGN_STG.TRADE_TXN_COMMODITY_SMRY

KYC_RGN_STG.TRADE_TXN_LC_SMRY_JURIS

No new data files are produced; only reject/error logs appear if problems occur.

Full sentence summary

The Load Status Update graph reads every record from the Load Status File and replicates it to the three regional branches — NAM, APAC, and IDN. Each branch executes only when its condition
(REGION != <Region>) and (<Region> member string_split_no_empty(DB_REGION_LIST,"\n")) evaluates true.
Within an active branch, the MUT component connects to that region’s database and runs four SQL UPDATE scripts that set LOAD_STATUS, LST_UPD_DT, LST_UPD_ID, and LST_UPD_TIME in the regional trade summary tables for the matching (id, id_type, client_type, country, month, year, batch_dt) key. Each record’s four updates occur in one transaction controlled by $COMMIT_TABLE; any database errors or constraint violations are sent to the region-specific Reject and Error files.
